# マルウエア
## 概要（当初版）
インターネットの一般利用者の立場から、サイパー犯罪とは何かを学ぶ。次にそれらの犯罪から身を守るために、マルウェアの種類や感染経路について述べる。

## キーワード（当初版）
サイバー犯罪、マルウェア、コンピュータウイルス

## 概要（学習のポイント）＜改訂版＞

## キーワード＜改訂版＞

# サイバー犯罪とは
サイバー空間における犯罪はサイバー犯罪と呼ばれている。
明確な定義はないものの、令和2年版警察白書によるサーバー犯罪の検挙情報では以下の区分が示されている
- 不正アクセス禁止法違反
- コンピュータ・電磁的記録対象犯罪
- 児童買春・児童ポルノ禁止法違反
- 詐欺
- 著作権法違反

不正アクセスに関わる行為では、その多くがパスワードといった識別符号の窃用となっており、設定・管理の甘さによる不正アクセスや、他人からの入手、元従業員や知人による不正アクセスが多くを占める結果となっていた。

また不正アクセス後の行為では、インターネットバンキングでの不正送金や、インターネットショッピングでの不正購入、メールの盗み見等の情報の不正入手が多くを締め、実害を伴う被害が起きていることがわかる。

一方、犯罪とまでは定義されないものの不正プログラムを用いてコンピュータに侵入するなどのサイバー攻撃の脅威も多くなっている。
侵入対象が重要インフラの基幹システムや、政府機関や企業などを対象にしているものもあり、それらへの対策も重要となっている。

# マルウェア
サイバー犯罪やサイバー攻撃は、ユーザによる設定の不備など人間的側面を狙って行うものと、不正なプログラムを利用して侵入や情報の詐取を行うものに大別される。
マルウェア（Malware）とは不正な行為を行う意図で作成された悪意のあるソフトウェアの総称である。
いろいろな種類がありいくつかの視点で分類されている。
たとえばウイルスやワーム、スパイウェア、アドウェア、ボット、バックドア、ランサムウェア、などが含まれる。

## 感染経路
マルウェアはさまざまな感染経路を持つ。ここではいくつか代表的な例を紹介する（図3）。
現代のマルウェアは下記の複数の経路により感染させるものや、感染後の拡大に複数の手段を使うなど巧妙化している。

![Figure1](figure03.png)


### 電子メール
電子メールにマルウェアがファイルとして添付されて、受信者が気づかずにそのファイルを実行することでその端末がマルウェアに感染するケースがこれにあたる。
このときユーザが信頼しやすい言葉が並べられるなどしてあたかも正しいメッセージであるかのように擬態し、ユーザにマルウェアの実行を促す。そのため形としては「ユーザがインストールを明示的に許可した」としてマルウェアがその端末にインストールされることとなる。

従来は電子メールに記載されている文章などは英語だけであったり、質の低い翻訳であったりするなど比較的判断が付きやすいものであったが、それらは次第に高度化してきており判断が難しくなってきている。2019年より広く感染が確認されているEmotetでは、正規にやりとりされているメール文章を利用しその返信を装って送られてくることがわかっている。また時期に応じた文面にするなど、ユーザに疑いを抱かせない手口となっている。

電子メールを介した感染では、ソフトウェアのプレビュー機能の脆弱性を狙い閲覧しただけで感染させることを狙うケースもある。


### Web閲覧
電子メールやメッセージングツール、SNSに掲載されたURLによりブラウザで悪意のあるページに誘導され、そこに掲載されている情報を見るだけで端末がマルウェアに感染するケースがある。
このケースでは主にブラウザの脆弱性が利用される。

また電子メール等のメッセージ本文にURLが記載されておりそこにアクセスするとマルウェアがダウンロードされ、ユーザが気づかずに実行することで端末がマルウェアに感染するケースもある。
このケースでは端末やメッセージングソフトウェアの脆弱性を利用するものではなく、電子メールの添付ファイルの実行と同様にURL以外の部分でユーザが信頼しやすい言葉を並べるなどして実行が促される。


### ネットワーク感染
ネットワーク通信をするソフトウェアの脆弱性を利用し感染を広げるタイプのマルウェアや、ファイル共有を利用して自身をコピーすることにより感染を広げるタイプのマルウェアが存在する。

### 外部記憶装置
あらかじめ感染している端末にUSBメモリ等の外部記憶装置が接続されると自分自身を外部記憶装置内にコピーし、その外部記憶装置が他の端末に接続した際に感染を広げさせるマルウェアが存在する。

## マルウェアの実体
マルウェアはそれ自体が単体のプログラムとして存在するケースと、他のプログラムに寄生するタイプに大別することができる。後者をウイルスと呼ぶこともある。
また前者のケースでは、無害なソフトウェアであると誤認させてインストールさせるものも存在する。


## マルウェアの種類
マルウェアはその機能によりさまざまな分類が行われる。ここではいくつかのマルウェアの種類を紹介する。
なお、それぞれの種類は厳密な用語定義や機能の分類が行われているわけではなく、慣例的に呼ばれていることが多い。
また近年のマルウェアは下記の種類の複数の機能を併せもつなど、高度化や複雑化している点も挙げられる。

### スパイウェア
スパイウェアは、端末を利用するユーザの情報などを収集し、それを情報を収集している外部の第3者に送信するソフトウェアである。
ユーザの意図に反してインストールされ、Web閲覧情報や利用しているソフトウェアの情報、さらには端末内の個人の情報を収集するなどの行為をする。

スパイウェアはさらに細分化され、キーボード入力を監視・記録してそれを外部に送信するキーボードロガーや、広告を強制的に表示させるアドウェアなどもスパイウェアと呼ばれる。


### バックドア
直訳すると「裏口」であり、その名称の通り感染したPCなどの端末に通常ではアクセスできない裏口を設け、攻撃者の侵入を導くソフトウェアである。
単体での脅威は少ないが、バックドアを通じた侵入により端末の内部にある情報が盗まれたり、その端末が接続しているネットワークを通じてさらに他の端末へと攻撃をするような用途に用いられるなどさらなる悪用につながるものである。


### ボット
感染した端末を攻撃者の管理下に置かれリモートから操作可能にされるようなソフトウェアをボットと呼ぶ。
ボットに感染した端末は同じく感染した他の端末とネットワーク化され攻撃者の指示のもとで一斉に操作されるなどの動きをする。
攻撃者が指示を行うサーバをC&C（Command and Control）サーバと呼び、ボットにより構成されたネットワークはボットネットと呼ばれる。
ボットネットは時間貸しや売買されるなど別のサイバー犯罪やサイバー攻撃に利用される。
たとえば特定の組織のサービスやシステムを狙ったDDoS攻撃や、特定の組織のWebサイトを装いユーザIDとパスワードを不正に取得するフィッシングサイトの構築、大量の広告メール送信、暗号通貨の採掘処理など、さまざまなケースが存在する。

ボットネットのC&Cサーバ追跡とその活動停止活動はテイクダウンと呼ばれ、2019年から2021年にかけて猛威をふるっていたEmotetではそのテイクダウンが過去にない大きな成功事例であるとして報告がされている。


### ランサムウェア
ランサムウェアは、感染した端末内のデータを使用不能にし普及するために金銭を要求するマルウェアである。
使用不能と復旧に暗号技術を利用することで高い脅威となっている。
2013年に登場したCryptoLockerは、金銭支払いや復号のための鍵取得に高い匿名性を持っており、利用する暗号技術も公開鍵暗号を用いるなど高い技術を持っていた。
金銭の支払いも匿名性の高いシステムを利用するなど、実害が大きく攻撃者の特定も難しいマルウェアとなっている。


### ダウンローダ
ダウンローダは、他のマルウェアをダウンロードする機能を持つマルウェアである。
単体ではマルウェアとして悪意のある活動をすることはなく、他のマルウェアをダウンロードして感染させることでさまざまな攻撃を行うことを可能にする。


## マルウェア感染の影響
データ等の情報が盗まれる（情報漏洩）

データ等の情報が破壊される：ランサムウェアとか

PCを悪用される（踏み台）：DDoS攻撃やフィッシングサイト、スパムメール送信



## 標的型攻撃
古くは（わざと古くって言っちゃっていいんじゃないかな）、ウイルスは感染したらそのことが感染端末の利用者に明らかにわかるような動作をしていた。個人による悪ふざけや自己顕示の発露として位置づけられていたのかもしれない。

それが時代を経て、犯罪の道具として利用されるようになってきた。「マルウェア感染の影響」にもあるように、その影響自体がある者にとっては価値のあるものとなったためである。
それに従い、マルウェアは感染の事実を隠避するようになり、またダウンローダのように感染したあとさらにその用途を変えた動きをするような自由度の高い攻撃ができるようになってきた。
感染した端末を多数保持し（ボットネット）それを貸与するようなサービスも現れた。

攻撃の対象も変遷してきている。古くは不特定多数に向けて配布されてきたマルウェアは、攻撃の対象を絞り特定の組織などを狙って行われるケースが出てきた。
当初から攻撃に明確な目標と目的があり、そのためにマルウェアが利用されるケースである。こういった攻撃を標的型攻撃と呼ぶ。
企業を狙った攻撃や、政府機関を狙った攻撃などが明らかになっている。


